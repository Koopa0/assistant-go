# Assistant Development Configuration
mode: development
log_level: debug
log_format: text

database:
  # 開發環境資料庫配置
  # 注意：生產環境必須使用環境變數 DATABASE_URL
  url: "${DATABASE_URL}" # 優先使用環境變數，避免硬編碼
  # PostgreSQL 17 優化設定（開發環境）
  max_connections: 15 # 開發環境減少連接數
  min_connections: 3 # 保持最小連接池
  max_idle_time: "10m" # 關閉閒置連接
  max_lifetime: "30m" # 開發環境較短的連接生命週期
  connect_timeout: "5s"
  migrations_path: "internal/platform/storage/postgres/migrations"
  enable_logging: true # 開發環境啟用日誌

server:
  address: ":8080"
  read_timeout: "10s"
  write_timeout: "10s"
  idle_timeout: "60s"
  shutdown_timeout: "30s"
  enable_tls: false
  static_dir: "internal/web/static"
  templates_dir: "internal/web/templates"
  rate_limit:
    enabled: true
    requests_per_second: 10
    burst_size: 20

cli:
  history_file: ".goassistant_history_dev"
  max_history_size: 1000
  enable_colors: true
  prompt_template: "Assistant[dev]> "

ai:
  default_provider: "claude"
  claude:
    api_key: "${CLAUDE_API_KEY}" # Will be overridden by environment variable
    model: "claude-3-sonnet-20240229"
    max_tokens: 4096
    temperature: 0.7
    base_url: "https://api.anthropic.com"
  gemini:
    api_key: "${GEMINI_API_KEY}" # Will be overridden by environment variable
    model: "gemini-pro"
    max_tokens: 4096
    temperature: 0.7
    base_url: "https://generativelanguage.googleapis.com"
  embeddings:
    provider: "claude"
    model: "text-embedding-ada-002"
    dimensions: 1536

tools:
  search:
    searxng_url: "http://localhost:8888"
    timeout: "30s"
    max_results: 10
    enable_cache: true
    cache_ttl: "1h"

  postgres:
    query_timeout: "30s"
    max_query_size: 1048576
    enable_explain: true

  kubernetes:
    namespace: "default"
    timeout: "30s"
    enable_metrics: true

  docker:
    host: "unix:///var/run/docker.sock"
    api_version: "1.41"
    timeout: "30s"
    tls_verify: false

  cloudflare:
    # API credentials should be set via environment variables

  langchain:
    enable_memory: true
    memory_size: 10
    max_iterations: 5
    timeout: "60s"

security:
  # JWT 配置 - 必須設定環境變數 SECURITY_JWT_SECRET
  jwt_secret: "${SECURITY_JWT_SECRET}" # 必須從環境變數載入
  jwt_expiration: "24h"
  rate_limit_rps: 100
  rate_limit_burst: 200
  enable_cors: true
  # 開發環境允許的 CORS 來源
  allowed_origins:
    - "http://localhost:3000"
    - "http://localhost:8080"
    - "http://127.0.0.1:3000"
    - "http://127.0.0.1:8080"

